$(function(){"use strict";module("modal plugin"),test("should be defined on jquery object",function(){var o=$('<div id="modal-test"></div>');ok(o.modal,"modal method is defined")}),module("modal",{setup:function(){$.fn.bootstrapModal=$.fn.modal.noConflict()},teardown:function(){$.fn.modal=$.fn.bootstrapModal,delete $.fn.bootstrapModal}}),test("should provide no conflict",function(){ok(!$.fn.modal,"modal was set back to undefined (orig value)")}),test("should return element",function(){var o=$('<div id="modal-test"></div>');ok(o.bootstrapModal()==o,"document.body returned"),$("#modal-test").remove()}),test("should expose defaults var for settings",function(){ok($.fn.bootstrapModal.Constructor.DEFAULTS,"default object exposed")}),test("should insert into dom when show method is called",function(){stop(),$.support.transition=!1,$('<div id="modal-test"></div>').on("shown.bs.modal",function(){ok($("#modal-test").length,"modal inserted into dom"),$(this).remove(),start()}).bootstrapModal("show")}),test("should fire show event",function(){stop(),$.support.transition=!1,$('<div id="modal-test"></div>').on("show.bs.modal",function(){ok(!0,"show was called")}).on("shown.bs.modal",function(){$(this).remove(),start()}).bootstrapModal("show")}),test("should not fire shown when default prevented",function(){stop(),$.support.transition=!1,$('<div id="modal-test"></div>').on("show.bs.modal",function(o){o.preventDefault(),ok(!0,"show was called"),start()}).on("shown.bs.modal",function(){ok(!1,"shown was called")}).bootstrapModal("show")}),test("should hide modal when hide is called",function(){stop(),$.support.transition=!1,$('<div id="modal-test"></div>').on("shown.bs.modal",function(){ok($("#modal-test").is(":visible"),"modal visible"),ok($("#modal-test").length,"modal inserted into dom"),$(this).bootstrapModal("hide")}).on("hidden.bs.modal",function(){ok(!$("#modal-test").is(":visible"),"modal hidden"),$("#modal-test").remove(),start()}).bootstrapModal("show")}),test("should toggle when toggle is called",function(){stop(),$.support.transition=!1;var o=$('<div id="modal-test"></div>');o.on("shown.bs.modal",function(){ok($("#modal-test").is(":visible"),"modal visible"),ok($("#modal-test").length,"modal inserted into dom"),o.bootstrapModal("toggle")}).on("hidden.bs.modal",function(){ok(!$("#modal-test").is(":visible"),"modal hidden"),o.remove(),start()}).bootstrapModal("toggle")}),test('should remove from dom when click [data-dismiss="modal"]',function(){stop(),$.support.transition=!1;var o=$('<div id="modal-test"><span class="close" data-dismiss="modal"></span></div>');o.on("shown.bs.modal",function(){ok($("#modal-test").is(":visible"),"modal visible"),ok($("#modal-test").length,"modal inserted into dom"),o.find(".close").click()}).on("hidden.bs.modal",function(){ok(!$("#modal-test").is(":visible"),"modal hidden"),o.remove(),start()}).bootstrapModal("toggle")}),test('should allow modal close with "backdrop:false"',function(){stop(),$.support.transition=!1;var o=$("<div>",{id:"modal-test","data-backdrop":!1});o.on("shown.bs.modal",function(){ok($("#modal-test").is(":visible"),"modal visible"),o.bootstrapModal("hide")}).on("hidden.bs.modal",function(){ok(!$("#modal-test").is(":visible"),"modal hidden"),o.remove(),start()}).bootstrapModal("show")}),test("should close modal when clicking outside of modal-content",function(){stop(),$.support.transition=!1;var o=$('<div id="modal-test"><div class="contents"></div></div>');o.on("shown.bs.modal",function(){ok($("#modal-test").length,"modal insterted into dom"),$(".contents").click(),ok($("#modal-test").is(":visible"),"modal visible"),$("#modal-test").click()}).on("hidden.bs.modal",function(){ok(!$("#modal-test").is(":visible"),"modal hidden"),o.remove(),start()}).bootstrapModal("show")}),test("should trigger hide event once when clicking outside of modal-content",function(){stop(),$.support.transition=!1;var o,t=$('<div id="modal-test"><div class="contents"></div></div>');t.on("shown.bs.modal",function(){o=0,$("#modal-test").click()}).on("hide.bs.modal",function(){o+=1,ok(1===o,"modal hide triggered once"),start()}).bootstrapModal("show")}),test('should close reopened modal with [data-dismiss="modal"] click',function(){stop(),$.support.transition=!1;var o=$('<div id="modal-test"><div class="contents"><div id="close" data-dismiss="modal"></div></div></div>');o.on("shown.bs.modal",function(){$("#close").click(),ok(!$("#modal-test").is(":visible"),"modal hidden")}).one("hidden.bs.modal",function(){o.one("hidden.bs.modal",function(){start()}).bootstrapModal("show")}).bootstrapModal("show"),o.remove()}),test("should restore focus to toggling element when modal is hidden after having been opened via data-api",function(){stop(),$.support.transition=!1;var o=$('<button data-toggle="modal" data-target="#modal-test">Launch modal</button>').appendTo("#qunit-fixture"),t=$('<div id="modal-test"><div class="contents"><div id="close" data-dismiss="modal"></div></div></div>');t.on("hidden.bs.modal",function(){window.setTimeout(function(){equal(document.activeElement,o[0],"toggling element is once again focused"),t.remove(),o.remove(),start()},0)}).on("shown.bs.modal",function(){$("#close").click()}).appendTo("#qunit-fixture"),o.click()}),test("should not restore focus to toggling element if the associated show event gets prevented",function(){stop(),$.support.transition=!1;var o=$('<button data-toggle="modal" data-target="#modal-test">Launch modal</button>').appendTo("#qunit-fixture"),t=$('<button id="other-btn">Golden boy</button>').appendTo("#qunit-fixture"),d=$('<div id="modal-test"><div class="contents"><div id="close" data-dismiss="modal"></div></div></div>');d.one("show.bs.modal",function(o){o.preventDefault(),t.focus(),window.setTimeout(function(){d.bootstrapModal("show")},0)}).on("hidden.bs.modal",function(){window.setTimeout(function(){equal(document.activeElement,t[0],"show was prevented, so focus should not have been restored to toggling element"),d.remove(),o.remove(),t.remove(),start()},0)}).on("shown.bs.modal",function(){$("#close").click()}).appendTo("#qunit-fixture"),o.click()})});